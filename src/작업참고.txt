[작업 참고]
1033 : 영어
1042 : 한국어
2052 : 중국어

틀고정 : PP1195-ALLOC 평준화 소스 참고

AlignCenter
AlignLeft
AlignRight

, IIF(ISNULL(DHMPOT.Status, '') = 'D', 1, 0)          AS ReadonlyVal  -- 읽기 전용
, IIF(ISNULL(DHMPOT.Status, '') = 'D', '#DCDCDC', '') AS RowColor     -- 삭제 색상

DI_HV_CO_PP_COMMON_JS_CSS

sp_helptext 

EXEC SP_HELP 'DI_CO_PP_WIP_ORDER'
EXEC SP_LOCK 
EXEC dbo.user_FindSPname 'MERGE'
EXEC dbo.user_SelectDictionary N'제약'
EXEC dbo.user_GetColumnNameComma 'DI_CO_PP_WIP_ORDER'
EXEC dbo.DI_SP_USER_TABLE_COLUMNS 'DI_CO_PP_WIP_ORDER'
EXEC dbo.DI_CO_SP_COMMON_CODE_COPY @Facility, @Module, @Code, @UserID

dbo.APR_GEN_Translation_Medium(TextID, @LanguageID, '')
dbo.DI_FN_FACILITY_NAME(DCSM.Facility, @LanguageID)
dbo.DI_FN_HV_PP_GetModelName(A.ReleasedFacility, A.ModelCode)
dbo.DI_FN_GetModelName(Facility, ModelCode)
dbo.DI_FN_GetWorkCenterName(A.ReleasedFacility, A.WorkCenter, A.LanguageID)
dbo.DI_FN_GetDepartmentName(A.ReleasedFacility, D.Department, A.LanguageID)
dbo.DI_FN_GetProductNo(DCSM.Facility, DCSP.ProductID) -- 대표사양
dbo.DI_FN_GetProductName(WI.ReleasedFacility, WI.ProductID, @LanguageID) -- 대표사양설명
dbo.DI_FN_GetDetailCodeName(ISNULL(V.Facility, '1000'), 'PP', 'MultiLevel', V.MultiLevel, @LanguageID)
dbo.DI_FNC_CO_GetDictionaryValue('DI_TITLE_Delete',@LanguageID,'M')
dbo.DI_FN_EmployeeNameByNo(EmployeeNo)
TDHPAPO.OrderLine IN (SELECT [VALUE] FROM dbo.DI_FN_Split(@LINE, ','))


dbo.CIM_F_Local_To_UTC(@VStartTime)
dbo.CIM_F_UTC_To_Local(@VStartTime)

gfnTuiNewGrid
gfnToastGrid

DI_FN_Get*Employee

dbo.DI_FN_GetPartnerName(PartnerID, @LanguageID)
dbo.DI_FN_GetPartnerNameByPartnerNo(PartnerNo, @LanguageID)
dbo.DI_FN_GetProductName(Facility, ProductID, @LanguageID)
dbo.DIOEM_FN_GetPartnerName(Facility, PartnerNo, @LanguageID)
###### dbo.DI_FN_GetProductNameByProductNo(Facility, ProductNo, @LanguageID)

dbo.DIOEM_FN_GetDecimalFormat(@NumberValue, @NullCheckYn)
dbo.DIOEM_FN_GetIntFormat(@NumberValue, @NullCheckYn)


DECLARE @Facility                NVARCHAR(40) = '1000/A'                   
      , @Module                  NVARCHAR(40) = 'LD'  
      , @ParentCode              NVARCHAR(80) = 'OEMSRC'  
      , @Code                    NVARCHAR(80) = 'F'
      , @LanguageID              INT          = 1042 ;
SELECT dbo.DI_FN_GetCodeName(@Facility, @Module, @ParentCode, @Code, @LanguageID)

DECLARE @Facility                NVARCHAR(40) = '1000/A'                   
      , @Module                  NVARCHAR(40) = 'LD'  
      , @ParentCode              NVARCHAR(80) = 'OEMSRC' 
      , @LanguageID              INT          = 1042 ;
SELECT * 
 FROM dbo.DI_FN_GetComCodeList(@Facility, @Module, @ParentCode, @LanguageID)


ROW_NUMBER() OVER (ORDER BY DC.Seq ASC)
ROW_NUMBER() OVER (PARTITION BY 컬럼명 ORDER BY DC.Seq ASC)
SUM(RemainQty) OVER (ORDER BY SortOrder ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS SumRemainQty


UPDATE DIOEM_CO_ST_JOB_RUN
   SET Status = 0
 WHERE Status = 99;

UPDATE DIOEM_CO_ST_JOB_RUN
   SET Status = 0
 WHERE Facility = '1000/B'
   AND JobCode = 'DIOEM_IF_SP_MM_ST_MATERIAL'
   AND Status = 99;

SELECT * FROM DIOEM_CO_ST_JOB_RUN WITH(NOLOCK) 
 WHERE Status = 99
 ORDER BY ID DESC;

EXEC SP_LOCK;
EXEC SP_WHO2;
SELECT 'dbcc inputbuffer (' + CAST(spid AS NVARCHAR(20)) + ');' AS DBCC_TEXT
     , 'KILL ' + CAST(spid AS NVARCHAR(20)) + ';' AS KILL_TEXT 
	   , 'SELECT * FROM sysobjects WHERE  id = ' + CAST(spid AS NVARCHAR(20)) + ';' AS SQL_TEXT
	   , * 
  FROM SYS.sysprocesses 
 WHERE BLOCKED > 0;

dbcc inputbuffer ( 86 );
dbcc inputbuffer ( 90 );
dbcc inputbuffer ( 105 );
dbcc inputbuffer ( 107 );

KILL 86;
KILL 90;
KILL 105
KILL 107

EXEC DIOEM_IF_SP_MM_PURCHASE_ORDER_DELIVERY_DOCUMENT '1000/A', 'SYSTEM'
EXEC DIOEM_IF_SP_MM_PURCHASE_ORDER_DELIVERY_DOCUMENT '1000/E', 'SYSTEM'


console.log("call_DI_HV_PC_PPCMAIN_REFRESH_ACT : " + message);


-- 테이블 정의서
SELECT A.Table_Name,
       C.Value Table_Description, 
       A.Ordinal_Position,
       A.Column_Name, 
       A.Data_Type, 
       CASE WHEN UPPER(A.Data_Type) = 'INT' THEN '4'
       	    WHEN UPPER(A.Data_Type) = 'SMALLINT' THEN '2'
       	    WHEN UPPER(A.Data_Type) = 'BIT' THEN '1'
       	    WHEN UPPER(A.Data_Type) = 'DATETIME' THEN '8'
       	    WHEN UPPER(A.Data_Type) = 'NVARCHAR' THEN CAST((A.Character_Maximum_Length / 2) AS VARCHAR)
       	    WHEN UPPER(A.Data_Type) = 'VARCHAR' THEN CAST((A.Character_Maximum_Length) AS VARCHAR)
       	    ELSE ISNULL(CAST((A.Character_Maximum_Length / 2) as VARCHAR), CAST((A.Numeric_Precision / 2) as VARCHAR) + ',' + CAST((A.Numeric_Scale / 2) as VARCHAR))
       	    END AS Column_Length, 
       A.Column_Default, 
       CASE WHEN A.Is_Nullable = 'YES' THEN 'Y' 
            ELSE 'N' 
            END AS Is_Nullable, 
       B.value Colum_Description 
  FROM INFORMATION_SCHEMA.ColumnS A 
       LEFT JOIN SYS.EXTENDED_PROPERTIES B 
       ON  B.Major_Id = OBJECT_ID(A.Table_Name) 
       AND B.Minor_Id = A.Ordinal_Position 
       LEFT JOIN (SELECT OBJECT_ID(Objname) Table_Id, Value FROM ::FN_LISTEXTENDEDPROPERTY(NULL, 'user','dbo','Table',NULL, NULL, NULL)) C 
       ON  C.Table_id = OBJECT_ID(A.Table_Name)
 WHERE A.Table_Name = 'DIOEM_HV_MM_AGGR_MONTH_INPUT' 
 ORDER BY A.Table_Name, A.Ordinal_Position
;


-- GPM 배포상태 조회
DECLARE @PackageName NVARCHAR(MAX) = 'DIOEM_HV_MM_NOT_DISPATCH_SCR,DIOEM_HV_MM_ERP_RETURN_SCR,DIOEM_HV_MM_RETURN_SCR';
WITH V_DATA AS (
SELECT ROW_NUMBER() OVER (ORDER BY FP.Name ASC, FPI.BuildNumber DESC, FPA.ActionType ASC)    AS No
      ,ROW_NUMBER() OVER (PARTITION BY FP.Name, FPI.BuildNumber ORDER BY FPA.ActionType ASC) AS Seq
      , FF.Name                  [폴더명]
      , FP.Name                  [패키지 명]
      --, FP.Comment_              [패키지 코멘트]
      , FPI.GenerationComment    [생성시 코멘트]
      , FPI.PackageCreatedOn     [패키지 생성시간]
      , FPI.PackageCreatedBy     [패키지 생성자]
      , FPI.BuildNumber          [빌드 번호]
      --, FPI.PackageSize       
      , FPI.TotalPackageSize     [패키지 총 사이즈]
      , FPA.CreatedOn            [액션 실행시간]
      , FPA.CreatedBy            [액션 실행자]
      --, FPA.LastUpdateOn      
      --, FPA.LastUpdatedBy     
      , FPAN.NodeName            [노드(작업) 위치]
      , CASE FPA.ActionType
             WHEN 1 THEN 'Send'
             WHEN 2 THEN 'Save'
             WHEN 3 THEN 'Deploy'
             WHEN 4 THEN 'Receive'
             WHEN 5 THEN 'Load'
             WHEN 6 THEN 'Generate'
             ELSE 'N/A'
        END AS [액션 타입]
      , CASE FPA.PackageStatus
             WHEN 1 THEN 'Processed'
             WHEN 2 THEN 'Failed'
             WHEN 3 THEN 'Pending'
             WHEN 4 THEN 'Processing'
             WHEN 5 THEN 'Cancelled'
             ELSE 'N/A'
        END AS [패키지 상태]
  FROM FDS_PROJECT FP
       INNER JOIN FDS_PACKAGE_INFO FPI
          ON FP.FUID = FPI.DefinitionFUID
       INNER JOIN FDS_PACKAGE_ACTION FPA
          ON FPI.ID = FPA.PackageInfoID
        LEFT JOIN FDS_PACKAGE_ACTION_NODE FPAN
          ON FPA.ID = FPAN.PackageActionID
        LEFT JOIN FDS_FOLDER FF
          ON FP.FolderID = FF.ID
WHERE FP.Name IN (SELECT [VALUE] FROM dbo.DI_FN_Split(@PackageName, ','))
) 
SELECT *
  FROM V_DATA VD
       INNER JOIN (
       		SELECT [폴더명], [패키지 명], MAX([빌드 번호]) AS [빌드 번호] FROM V_DATA GROUP BY [폴더명], [패키지 명]
       ) VMAX
       ON  VD.[폴더명]   = VMAX.[폴더명]
       AND VD.[패키지 명] = VMAX.[패키지 명]
       AND VD.[빌드 번호] = VMAX.[빌드 번호]
ORDER BY VD.No ASC


SELECT ID, dbo.APR_GEN_Translation_Medium(TextID, 1033, ''),* FROM REVISION_STATUS
/*
0    Design in Progress
1    Active
2    Cancelled
3    On Hold
4    Prototype
5    Compiling in Process
6    Development in Progress
*/

SELECT * FROM OPERATION WHERE OperationCode = 'DI_HV_PC_PPCMAIN_PLAN_VIEW'
/*
BEGIN TRAN
UPDATE OPERATION
   SET RevisionStatusID = 4
WHERE OperationCode = 'DI_HV_PC_PPCMAIN_PLAN_VIEW'
*/
--COMMIT

-- DB LINK 확인
SELECT * FROM master.dbo.sysservers 

-- 테이블 용량
EXEC dba_SpaceUsed 'FlexNet', 'U'
EXEC sp_spaceused 'DI_HV_PP_ALLOC_PRIORITY'

SELECT CONVERT(VARCHAR(30), MIN(o.name)) AS t_name     
     , LTRIM(STR(SUM(reserved) * 8192.0 / 1024.0, 15, 0) + ' KB') AS t_size
  FROM sysindexes i           
       INNER JOIN sysobjects o 
       ON o.id = i.id
 WHERE i.indid IN (0, 1, 255)   
   AND o.xtype = 'U'
   AND o.name = 'DI_HV_PP_PROD_REPORT'       
 GROUP BY i.id
 ORDER BY t_name ASC, SUM(reserved) * 8192.0 / 1024.0 DESC
 ;


-- 테이블 건수
SELECT o.name     
     , i.rows
  FROM sysindexes i           
       INNER JOIN sysobjects o 
       ON i.id = o.id
 WHERE i.indid < 2   
   AND o.xtype = 'U'
   AND o.name = 'DI_HV_PP_PROD_REPORT'  
 ORDER BY i.rows DESC
 ; 

-- SP 내용검색
SELECT OBJECT_NAME(object_id)       AS SP_NAME
     , OBJECT_DEFINITION(object_id) AS SP_CONTENT
  FROM syVPPO.procedures
 WHERE OBJECT_DEFINITION(object_id) LIKE '%DI_HV_PP_ALLOC_PRIORITY%'
 ;

-- FN/SP 내용 조회
SELECT name [Stored Procedure Name]
  FROM sys.objects with (nolock)
WHERE object_id IN (
    SELECT object_id
    FROM sys.sql_modules with (nolock)
    WHERE definition LIKE '%DIOEM_HV_MM_INVENTORY%'
      AND definition LIKE '%LastGIDate%'
      AND definition LIKE '%UPDATE%'
    )
ORDER BY 1 ASC;

 SELECT HC.Facility
     , DC.Code                                              AS Code
     , dbo.APR_GEN_Translation_Medium(DC.TextID, 1042, '')  AS Name
  FROM DI_CO_TT_COMMON_HEAD_CODE HC WITH(NOLOCK)
       INNER JOIN DI_CO_TT_COMMON_DETAIL_CODE DC WITH(NOLOCK)
       ON  HC.ID   = DC.ID
       AND HC.Code = DC.ParentCode 
 WHERE HC.Facility IN ('1000', '1111', '1200')
   AND HC.Module   = 'CO'
   AND HC.Code     = 'VERSION_ID_CODE'	;


-- CREATE PROCEDURE [dbo].[DICC_CO_PP_BOOM_ARM_KIT_INPUT_STATUS]( -- 참고
DECLARE CUR_KIT_LIST CURSOR LOCAL FOR
SQL 문
OPEN CUR_KIT_LIST
FETCH NEXT FROM CUR_KIT_LIST INTO @cProductionVersion,@cProductNo,@cModelCodeSerialNo,@cModelName,@cOperationStatus
        
WHILE (@@FETCH_STATUS = 0)
BEGIN 

    FETCH NEXT FROM CUR_KIT_LIST INTO @cProductionVersion,@cProductNo,@cModelCodeSerialNo,@cOperationStatus
END

IF (SELECT CURSOR_STATUS('global','CUR_KIT_LIST')) >= -1
BEGIN
  CLOSE CUR_KIT_LIST
  DEALLOCATE CUR_KIT_LIST
END

ValueBag

// 평준화 버튼 클릭
function fnAllocLeveling(){
	alert(CON_LEFT_CONTEXDHPAPO.literalVPPO.ERR_NotData);
}

[Git 편집기로서의 VS Code]
1. code --help명령줄에서 실행할 수 있는지 확인 하고 도움을 받으세요.
  - Windows: 설치 중에 PATH에 추가를 선택했는지 확인하십시오 .
  - C:\Users\iv0106464\AppData\Local\Programs\Microsoft VS Code\_\
2. 명령줄에서 다음을 실행합니다.
  - git config --global core.editor "code --wait"

3. 설정
git config --global -e
##########################
[diff]
    tool = default-difftool
[difftool "default-difftool"]
    cmd = code --wait --diff $LOCAL $REMOTE
[merge]
    tool = code
[mergetool "code"]
    cmd = code --wait --merge $REMOTE $LOCAL $BASE $MERGED

  
DECLARE @iOptionCode NVARCHAR(1500) = 'C_ABOM044 OR C_ABOM046 OR C_ABOMART AND NOT C_AARMNON' -- Option Code  
SELECT * 
  FROM DBO.DIOEM_FN_HV_PP_GET_OPTION_CODE_PARSING(@iOptionCode) ;

DECLARE @iOptionCode NVARCHAR(1500) = '((C_HCTV2SV OR C_HCTV3SV) AND C_EEMIS5R) OR ((C_HCTV2SV OR C_HCTV3SV) AND NOT C_EEMIT4E)' -- Option Code  
SELECT * 
  FROM DBO.DIOEM_FN_HV_PP_GET_OPTION_CODE_PARSING(@iOptionCode);


filter: 'number'

// v3
const grid = new Grid({
  // ...
  columns: [
    {
      name: 'artist',
      title: 'Artist',
      formatter(value, rowData) {
        // ...
      }
    }
  ]
});

// v4
const grid = new Grid({
  // ...
  columns: [
    {
      name: 'artist',
      header: 'Artist',
      formatter({ row, column, value }) {
        // ...
      }
    }
  ]
});


			var sumtemp =  {
				template: function(valueMap) {
					return NumComma(valueMap.sum);
				}
			};
		            {
		                sortable: true,
		                title: '수량',
		                name: 'qty1',
						        minWidth: '80',
						        formatter: NumComma,
		                align: 'right'
		            },

		            {
		                sortable: true,
		                title: '수량',
		                name: 'qty5',
						        minWidth: '80',
						        formatter: function(value){
						            return NumComma(value) + ' %'
						        },
		                align: 'right'
		            },


			    summary: {
			        height: 25,
					position: 'bottom',
					columnContent: {
						qty1: sumtemp,
						price1: sumtemp,
						amt1: sumtemp,
						qty2: sumtemp,
						price2: sumtemp,
						amt2: sumtemp,
						qty3: sumtemp,
						price3: sumtemp,
						amt3: sumtemp,
						qty4: sumtemp,
						amt4: sumtemp,
						qty5: sumtemp,
						amt5: sumtemp
					}
			    }
		    });


            formatter: function(e){
                return `<a href="javascript:void(0)">${e.value.substring(0,2)} / ${e.value.substring(2,4)}</a>`; 
            },


var grid = new tui.Grid({
    el: $('#grid'),
    data: [
        {
            price: 1001
        },
        {
            price: 325
        },
        {
            price: 8020
        },
        {
            price: 0
        },
        {
            price: 1
        }
    ],
    columns: [
        {
            title: 'price',
            name: 'price',
            sortable: true,
            formatter: function(value) {
                return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') + '%';
            }
        }
    ]
});

// 숫자 콤마 처리
function gfnNumComma(value){
    let aValue;
    let result = "";
	
	//console.log("typeof(value) ==> " + typeof(value)+", value ==> " + value);
	if("number" == typeof(value)){
        if(value.toString().indexOf('.') < 0){ // 정수(음수, 양수)일 경우
            if(value.toString().indexOf('-') < 0) result = value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ','); // 양수
            else result =  "-" + value.toString().substring(1).replace(/\B(?=(\d{3})+(?!\d))/g, ','); // 음수
        }else{ // 소수
            aValue = value.toString().split(".");
            if(aValue[0].indexOf('-') < 0) result = aValue[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',') + "." + aValue[1]; // 양의 소수
            else result =  "-" + aValue[0].substring(1).replace(/\B(?=(\d{3})+(?!\d))/g, ',') + "." + aValue[1]; // 음의 소수
        }
    }else{ // 숫자(실수)가 아닌 경우
        result = value;
	}
    return result;
}

$Context.literals.BTN_COMPLETE
alert(CON_CONTEXT_RIGHT.literals.ERR_RealPhenomenaCode);

총 행수를 반환 : number
getRowCount()

getSummaryValues(columnName)

-- 참조키값
SET @vReferenceID = SCOPE_IDENTITY() ;
IF (@@ROWCOUNT > 0)

click

onGridMounted


-- ToastUI 오퍼레이션
DIOEM_HV_MM_GET_TOAST_UI_GRID_DATA
-- ToastUI MAIN SP
DIOEM_HV_MM_TOAST_UI_GRID_DATA_SERVICE
    -- HEADER 
    DIOEM_HV_MM_TOAST_UI_GRID_DATA_HEADER_DATA_RESPONSE
    -- ROW
    DIOEM_HV_MM_TOAST_UI_GRID_DATA_ROW_DATA_RESPONSE


gfnShowSnackBar("warning", '조회된 Data가 없습니다.');

AND CAST(ISNULL(DCPWOR.CurrentAssemblyStatus, '0') AS INT) < 900



###############################################################
###############################################################
###############################################################
###############################################################
###############################################################


SELECT DC.Code AS Value
     , CONCAT('[', DC.Code, '] ', dbo.APR_GEN_Translation_Medium(DC.TextID, @LanguageID, '')) AS Text
  FROM DI_CO_TT_COMMON_HEAD_CODE HC WITH(NOLOCK)
       INNER JOIN DI_CO_TT_COMMON_DETAIL_CODE DC WITH(NOLOCK)
       ON  HC.ID       = DC.ID
       AND HC.Active   = DC.Active
 WHERE HC.Facility = @EXT_Facility_SC
   AND HC.Module   = 'LD'
   AND HC.Code     = 'OEMERPReturnStatus'
   AND HC.Active   = 1
 ORDER BY DC.Seq ASC




DECLARE @PackageName NVARCHAR(MAX) = 'DIOEM_HV_MM_CABIN_GR_SCR,DIOEM_HV_MM_ERP_PURCHASE_STATUS_SCR,DIOEM_HV_MM_MONTH_PURCHASE_SEARCH_SCR';
WITH V_DATA AS (
    SELECT ROW_NUMBER() OVER (ORDER BY FP.Name ASC, FPI.BuildNumber DESC, FPA.ActionType ASC)    AS No
          ,ROW_NUMBER() OVER (PARTITION BY FP.Name, FPI.BuildNumber ORDER BY FPA.ActionType ASC) AS Seq
          , FF.Name                  [폴더명]
          , FP.Name                  [패키지 명]
          --, FP.Comment_              [패키지 코멘트]
          , FPI.GenerationComment    [생성시 코멘트]
          , FPI.PackageCreatedOn     [패키지 생성시간]
          , FPI.PackageCreatedBy     [패키지 생성자]
          , FPI.BuildNumber          [빌드 번호]
          --, FPI.PackageSize       
          , FPI.TotalPackageSize     [패키지 총 사이즈]
          , FPA.CreatedOn            [액션 실행시간]
          , FPA.CreatedBy            [액션 실행자]
          --, FPA.LastUpdateOn      
          --, FPA.LastUpdatedBy     
          , FPAN.NodeName            [노드(작업) 위치]
          , CASE FPA.ActionType
                 WHEN 1 THEN 'Send'
                 WHEN 2 THEN 'Save'
                 WHEN 3 THEN 'Deploy'
                 WHEN 4 THEN 'Receive'
                 WHEN 5 THEN 'Load'
                 WHEN 6 THEN 'Generate'
                 ELSE 'N/A'
            END AS [액션 타입]
          , CASE FPA.PackageStatus
                 WHEN 1 THEN 'Processed'
                 WHEN 2 THEN 'Failed'
                 WHEN 3 THEN 'Pending'
                 WHEN 4 THEN 'Processing'
                 WHEN 5 THEN 'Cancelled'
                 ELSE 'N/A'
            END AS [패키지 상태]
      FROM FDS_PROJECT FP
           INNER JOIN FDS_PACKAGE_INFO FPI
              ON FP.FUID = FPI.DefinitionFUID
           INNER JOIN FDS_PACKAGE_ACTION FPA
              ON FPI.ID = FPA.PackageInfoID
            LEFT JOIN FDS_PACKAGE_ACTION_NODE FPAN
              ON FPA.ID = FPAN.PackageActionID
            LEFT JOIN FDS_FOLDER FF
              ON FP.FolderID = FF.ID
    WHERE FP.Name IN (SELECT [VALUE] FROM dbo.DI_FN_Split(@PackageName, ','))
) 
SELECT *
  FROM V_DATA VD
       INNER JOIN (
       		SELECT [폴더명], [패키지 명], MAX([빌드 번호]) AS [빌드 번호] FROM V_DATA GROUP BY [폴더명], [패키지 명]
       ) VMAX
       ON  VD.[폴더명]   = VMAX.[폴더명]
       AND VD.[패키지 명] = VMAX.[패키지 명]
       AND VD.[빌드 번호] = VMAX.[빌드 번호]
ORDER BY VD.No ASC


###############################################################
###############################################################
###############################################################
###############################################################

BEGIN TRY

END TRY  
BEGIN CATCH  
  IF @@TRANCOUNT > 0 ROLLBACK TRAN;

  SET @JOB_RESULT_CD = 'N' ;
  SET @JOB_RESULT_MSG = LEFT(ERROR_MESSAGE(), 1000);

  PRINT 'CATCH ERROR: ' + @JOB_RESULT_MSG

  -- 작업완료보고(99: 시작, 0: 종료, -1: 에러)
  EXEC DIOEM_CO_SP_ST_JOB_RUN_LOG	@JOB_FACILITY, @JOB_CODE, @JOB_NAME, @JOB_CODE, @JOB_STEP,@JOB_STEP_NAME, -1, @JOB_USERID, @JOB_RESULT_MSG, @JOB_RESULT_CD OUTPUT, @JOB_RESULT_MSG OUTPUT;
END CATCH 


###############################################################
###############################################################
###############################################################
###############################################################

-- DB 배치 Job 내부에서 EAI 호출하는 경우
SET TEXTSIZE 2147483647
EXEC DI_SP_CO_LD_SHORTAGE_CHECK_STOCK '1000'
